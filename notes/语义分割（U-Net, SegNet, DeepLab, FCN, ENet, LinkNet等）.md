### 语义分割（U-Net, SegNet, DeepLab, FCN, ENet, Mask-RCNN等）

------

一些思考

一般语义分割的过程：编码+解码

* 下采样的意义

  ​鲁棒性，感受野，降噪

* 增加参数

   合理的去调整网络的结构使得增加的参数有效果而不是盲目的增加参数

* 概率相关

  DeepLab和Bayes SegNet都添加了概率因素在网络中

* 网络结构的创新如FCN,U-Net（0->1）,之后会衍生出各种产物

* 优化，如U-Net++中的剪枝

   ​



1. U-Net

    * 基本步骤
      * 特征提取，通过池化实现5个尺度
      * 上采样，将上采样后的特征图与对应的通道数相同尺度的特征提取部分的特征图融合
      * 计算损失

    * 技术细节

      * U-net采用将特征在channel维度拼接在一起，形成更厚的特征。

        (能够为分割提供更加精细的特征)

        PS. FCN融合时使用的对应点相加，并不形成更厚的特征。

      * 5个pooling layer实现了网络对图像特征的多尺度特征识别

      * 加权处理：类别平衡和给两个细胞之间的空隙更大的权重 

    * Unet++

      * 长短连接相结合，深监督+剪枝

 2. SegNet

    * 基本步骤
      * vgg前13层训练encoder
      * decoder（关键）
      * softmax实现像素级别分类
    * 技术细节
      * encoder-decoder结构
      * decoder中保存池化层的索引，上采样的时候直接根据索引进行填入（不需要学习）（关键创新点）
      * 接着通过可学习的卷积进行填充

 3. DeepLab

    * 基本步骤

      * 采用了**FCN**得到 coarse score map并插值到原图像大小
      * 借用fully connected CRF对从FCN得到的分割结果进行细节上的refine

    * 技术细节

      * 解决问题dense feature map和RF之间的矛盾：

        将pool层的stride改成1，feature map更加dense，但是感受野变小了

      * 采用hole算法，在卷积核中增加空洞，卷积核变大，使得感受野变大

      * CRF，增加分割的精确度？ 

    * v2

      借用spp思想，对用同一个feature map采用不同大小的空洞卷积，然后进行**Eltwise Add**
  4. FCN

    * 基本步骤：
      * VGG提取特征，得到特征map，最后3个的全连接层换成卷积层
      * 利用上采样和反卷积到原图像大小
      * 在上采样的特征图上做像素级的分类
    * 技术细节：
      * 卷积层与全连接层之间的互相转化的原理
      * 通过反卷积（deconvolution）实现上采样（可学习参数，双线性插值进行初始化）
      * 对不同的pool层反卷积相加来补充细节
    * 存在问题：
      * 分割结果细节不够好,是对各个像素进行分类
      * 没有充分考虑像素与像素之间的关系


5. E-Net

    实时分割，网络参数少，

    * 基本步骤
      * 编码解码

    * 技术特点

      * 采用segNet保留索引的方式来减少空间位置得到信息损失

      * 前两个block极大得到减小尺寸

      * 非对称的解码，原因是编码层应该像原始分类网络的结构相似。用于处理较小的数据，同时进行信息的处理与滤波，解码网络对编码网络的输出进行上采样用于对细节的微调。

      * 前半部分进行下采样，剧烈的维度衰减不利于信息的流动，在池化层后接一个卷积层增加了维度，进而增加了计算资源

        原始的ResNet的结构中，进行下采样时，第一个1x1的映射，在所有维度上进行的是步长为2的卷积，丢弃了75%左右的输入信息。将卷积核增加至2x2利于信息的保留。

      * 分解卷积核

      * 空洞卷积

      * dropout

6. Mask-RCNN

    实例分割

    * 基本步骤

      faster-rcnn+FCN产生对应的MASK分支

      * 输入图片到一个预训练好的神经网络中获得对应的feature map；
      * 找出RPN
      * 对RPN找到的每个RoI进行分类、定位、并找到binary mask

    * 技术特点

      * ROIAlign（原图和feature map的pixel对应起来，然后将feature map和固定的feature对应起来）

        https://blog.csdn.net/u011918382/article/details/79455407

        ​